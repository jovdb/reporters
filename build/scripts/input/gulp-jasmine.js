var chalk=require("chalk");module.exports=function(e,s){"use strict";s=s||{};var t=0,a=0,i=0,l=[],r=s&&s.logSpecs;return{specStarted:function(e){r&&console.log("unit test: "+chalk.cyan(e.fullName))},specDone:function(e){if("passed"===e.status?t++:"skipped"===e.status&&a++,"failed"===e.status){i++;for(var s=0;s<e.failedExpectations.length;s++){var r=e.failedExpectations[s],c=this.filterStackTraces(r.stack);if(c&&c.length){var n=this.getFileAtLineFromStack(c[0]);l.push(n?{specName:e.description,specFullName:e.fullName,description:e.fullName+": "+r.message,filePath:n.filePath,lineNbr:n.lineNbr,colNbr:n.colNbr,sourceName:"gulp-jasmine",type:"error"}:{specName:e.description,specFullName:e.fullName,description:e.fullName+": "+c.join("\n"),sourceName:"gulp-jasmine",type:"error"})}else l.push({specName:e.description,specFullName:e.fullName,description:e.fullName+": "+(r.stack||r.message),sourceName:"gulp-jasmine",type:"error"})}}},jasmineDone:function(){var s="",r="info";i>0?(s=i+" of "+(i+t)+" tests failed"+(a>0?", "+a+" skipped.":"."),r="error"):s=a>0&&t>0?t+" tests executed successful, "+a+" skipped.":t>0?"All "+t+" tests completed successful.":"No tests executed.",l.push({description:s,sourceName:"gulp-jasmine",type:r}),e(l),t=0,a=0,i=0,l=[]},filterStackTraces:function(e){for(var s=e.split("\n"),t=[],a=1;a<s.length;a++)/(jasmine[^\/]*\.js|Timer\.listOnTimeout)/.test(s[a])||t.push(s[a]);return t},getFileAtLineFromStack:function(e){var s=/.*\((.*):(.*):(.*)\).*/g,t=s.exec(e);return t?{filePath:t[1],lineNbr:parseInt(t[2],10),colNbr:parseInt(t[3],10)}:void 0}}};